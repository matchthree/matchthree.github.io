(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))S(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const w of d.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&S(w)}).observe(document,{childList:!0,subtree:!0});function E(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerPolicy&&(d.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?d.credentials="include":r.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function S(r){if(r.ep)return;r.ep=!0;const d=E(r);fetch(r.href,d)}})();window.onload=function(){const h=document.getElementById("viewport"),i=h.getContext("2d");let E=0,S=0,r=0,d=0,w=!1;const o={x:250,y:113,columns:8,rows:8,tilewidth:40,tileheight:40,tiles:[],selectedtile:{selected:!1,column:0,row:0}},L=[[255,128,128],[128,255,128],[128,128,255],[255,255,128],[255,128,255],[128,255,255],[255,255,255]];let u=[],x=[],s={column1:0,row1:0,column2:0,row2:0};const m={init:0,ready:1,resolve:2};let y=m.init,B=0,a=0,c=0;const g=.3;let C=!1,O=!1,A=!1;const F=[{x:30,y:240,width:150,height:50,text:"New Game"},{x:30,y:300,width:150,height:50,text:"Show Moves"},{x:30,y:360,width:150,height:50,text:"Enable AI Bot"}];function U(){h.addEventListener("mousemove",oe),h.addEventListener("mousedown",ie),h.addEventListener("mouseup",ne),h.addEventListener("mouseout",se);for(let e=0;e<o.columns;e++){o.tiles[e]=[];for(let t=0;t<o.rows;t++)o.tiles[e][t]={type:0,shift:0}}V(),N(0)}function N(e){window.requestAnimationFrame(N),X(e),J()}function X(e){const t=(e-E)/1e3;if(E=e,Y(t),y===m.ready){if(x.length<=0&&(A=!0),O&&(c+=t,c>g)){if(j(),x.length>0){const l=x[Math.floor(Math.random()*x.length)];P(l.column1,l.row1,l.column2,l.row2)}c=0}}else if(y===m.resolve){if(c+=t,a===0){if(c>g){if(p(),u.length>0){for(const l of u)B+=100*(l.length-2);G(),a=1}else y=m.ready;c=0}}else a===1?c>g&&(D(),a=0,c=0,p(),u.length<=0&&(y=m.ready)):a===2?c>g&&(b(s.column1,s.row1,s.column2,s.row2),p(),u.length>0?(a=0,c=0,y=m.resolve):(a=3,c=0),j(),p()):a===3&&c>g&&(b(s.column1,s.row1,s.column2,s.row2),y=m.ready);j(),p()}}function Y(e){S>.25&&(d=Math.round(r/S),S=0,r=0),S+=e,r++}function I(e,t,l,n){const f=i.measureText(e);i.fillText(e,t+(n-f.width)/2,l)}function J(){Q(),i.fillStyle="#000000",i.font="24px Verdana",I("Score:",30,o.y+40,150),I(B.toString(),30,o.y+70,150),W();const e=o.columns*o.tilewidth,t=o.rows*o.tileheight;i.fillStyle="#000000",i.fillRect(o.x-4,o.y-4,e+8,t+8),Z(),_(),C&&u.length<=0&&y===m.ready&&k(),A&&(i.fillStyle="rgba(0, 0, 0, 0.8)",i.fillRect(o.x,o.y,e,t),i.fillStyle="#ffffff",i.font="24px Verdana",I("Game Over!",o.x,o.y+t/2+10,e))}function Q(){i.fillStyle="#d0d0d0",i.fillRect(0,0,h.width,h.height),i.fillStyle="#e8eaec",i.fillRect(1,1,h.width-2,h.height-2),i.fillStyle="#303030",i.fillRect(0,0,h.width,65),i.fillStyle="#ffffff",i.font="24px Verdana",i.fillText("Match3 Example - Rembound.com",10,30),i.fillStyle="#ffffff",i.font="12px Verdana",i.fillText(`Fps: ${d}`,13,50)}function W(){for(const e of F){i.fillStyle="#000000",i.fillRect(e.x,e.y,e.width,e.height),i.fillStyle="#ffffff",i.font="18px Verdana";const t=i.measureText(e.text);i.fillText(e.text,e.x+(e.width-t.width)/2,e.y+30)}}function Z(){for(let e=0;e<o.columns;e++)for(let t=0;t<o.rows;t++){const l=o.tiles[e][t].shift,n=v(e,t,0,c/g*l);if(o.tiles[e][t].type>=0){const f=L[o.tiles[e][t].type];M(n.tilex,n.tiley,f[0],f[1],f[2])}o.selectedtile.selected&&o.selectedtile.column===e&&o.selectedtile.row===t&&M(n.tilex,n.tiley,255,0,0)}if(y===m.resolve&&(a===2||a===3)){const e=s.column2-s.column1,t=s.row2-s.row1,l=v(s.column1,s.row1,0,0),n=v(s.column1,s.row1,c/g*e,c/g*t),f=L[o.tiles[s.column1][s.row1].type],T=v(s.column2,s.row2,0,0),$=v(s.column2,s.row2,c/g*-e,c/g*-t),R=L[o.tiles[s.column2][s.row2].type];M(l.tilex,l.tiley,0,0,0),M(T.tilex,T.tiley,0,0,0),a===2?(M(n.tilex,n.tiley,f[0],f[1],f[2]),M($.tilex,$.tiley,R[0],R[1],R[2])):(M($.tilex,$.tiley,R[0],R[1],R[2]),M(n.tilex,n.tiley,f[0],f[1],f[2]))}}function v(e,t,l,n){const f=o.x+(e+l)*o.tilewidth,T=o.y+(t+n)*o.tileheight;return{tilex:f,tiley:T}}function M(e,t,l,n,f){i.fillStyle=`rgb(${l},${n},${f})`,i.fillRect(e+2,t+2,o.tilewidth-4,o.tileheight-4)}function _(){for(const e of u){const t=v(e.column,e.row,0,0);e.horizontal?(i.fillStyle="#00ff00",i.fillRect(t.tilex+o.tilewidth/2,t.tiley+o.tileheight/2-4,(e.length-1)*o.tilewidth,8)):(i.fillStyle="#0000ff",i.fillRect(t.tilex+o.tilewidth/2-4,t.tiley+o.tileheight/2,8,(e.length-1)*o.tileheight))}}function k(){for(const e of x){const t=v(e.column1,e.row1,0,0),l=v(e.column2,e.row2,0,0);i.strokeStyle="#ff0000",i.beginPath(),i.moveTo(t.tilex+o.tilewidth/2,t.tiley+o.tileheight/2),i.lineTo(l.tilex+o.tilewidth/2,l.tiley+o.tileheight/2),i.stroke()}}function V(){B=0,y=m.ready,A=!1,ee(),j(),p()}function ee(){let e=!1;for(;!e;){for(let t=0;t<o.columns;t++)for(let l=0;l<o.rows;l++)o.tiles[t][l].type=z();te(),j(),x.length>0&&(e=!0)}}function z(){return Math.floor(Math.random()*L.length)}function te(){for(p();u.length>0;)G(),D(),p()}function p(){u=[];for(let e=0;e<o.rows;e++){let t=1;for(let l=0;l<o.columns;l++){let n=!1;l===o.columns-1?n=!0:o.tiles[l][e].type===o.tiles[l+1][e].type&&o.tiles[l][e].type!==-1?t+=1:n=!0,n&&(t>=3&&u.push({column:l+1-t,row:e,length:t,horizontal:!0}),t=1)}}for(let e=0;e<o.columns;e++){let t=1;for(let l=0;l<o.rows;l++){let n=!1;l===o.rows-1?n=!0:o.tiles[e][l].type===o.tiles[e][l+1].type&&o.tiles[e][l].type!==-1?t+=1:n=!0,n&&(t>=3&&u.push({column:e,row:l+1-t,length:t,horizontal:!1}),t=1)}}}function j(){x=[];for(let e=0;e<o.rows;e++)for(let t=0;t<o.columns-1;t++)b(t,e,t+1,e),p(),b(t,e,t+1,e),u.length>0&&x.push({column1:t,row1:e,column2:t+1,row2:e});for(let e=0;e<o.columns;e++)for(let t=0;t<o.rows-1;t++)b(e,t,e,t+1),p(),b(e,t,e,t+1),u.length>0&&x.push({column1:e,row1:t,column2:e,row2:t+1});u=[]}function le(e){for(let t=0;t<u.length;t++){const l=u[t];let n=0,f=0;for(let T=0;T<l.length;T++)e(t,l.column+n,l.row+f,l),l.horizontal?n++:f++}}function G(){le((e,t,l,n)=>{console.info(`${e}`),console.info(`${n}`),o.tiles[t][l].type=-1});for(let e=0;e<o.columns;e++){let t=0;for(let l=o.rows-1;l>=0;l--)o.tiles[e][l].type===-1?(t++,o.tiles[e][l].shift=0):o.tiles[e][l].shift=t}}function D(){for(let e=0;e<o.columns;e++)for(let t=o.rows-1;t>=0;t--){if(o.tiles[e][t].type===-1)o.tiles[e][t].type=z();else{const l=o.tiles[e][t].shift;l>0&&b(e,t,e,t+l)}o.tiles[e][t].shift=0}}function q(e){const t=Math.floor((e.x-o.x)/o.tilewidth),l=Math.floor((e.y-o.y)/o.tileheight);return t>=0&&t<o.columns&&l>=0&&l<o.rows?{valid:!0,x:t,y:l}:{valid:!1,x:0,y:0}}function H(e,t,l,n){return Math.abs(e-l)===1&&t===n||Math.abs(t-n)===1&&e===l}function b(e,t,l,n){const f=o.tiles[e][t].type;o.tiles[e][t].type=o.tiles[l][n].type,o.tiles[l][n].type=f}function P(e,t,l,n){s={column1:e,row1:t,column2:l,row2:n},o.selectedtile.selected=!1,a=2,c=0,y=m.resolve}function oe(e){const t=K(h,e);if(w&&o.selectedtile.selected){const l=q(t);l.valid&&H(l.x,l.y,o.selectedtile.column,o.selectedtile.row)&&P(l.x,l.y,o.selectedtile.column,o.selectedtile.row)}}function ie(e){const t=K(h,e);if(!w){const l=q(t);if(l.valid){let n=!1;if(o.selectedtile.selected)if(l.x===o.selectedtile.column&&l.y===o.selectedtile.row){o.selectedtile.selected=!1,w=!0;return}else H(l.x,l.y,o.selectedtile.column,o.selectedtile.row)&&(P(l.x,l.y,o.selectedtile.column,o.selectedtile.row),n=!0);n||(o.selectedtile.column=l.x,o.selectedtile.row=l.y,o.selectedtile.selected=!0)}else o.selectedtile.selected=!1;w=!0}for(const l of F)t.x>=l.x&&t.x<l.x+l.width&&t.y>=l.y&&t.y<l.y+l.height&&(l.text==="New Game"?V():l.text.includes("Show Moves")||l.text.includes("Hide Moves")?(C=!C,l.text=(C?"Hide":"Show")+" Moves"):(l.text.includes("Enable AI Bot")||l.text.includes("Disable AI Bot"))&&(O=!O,l.text=(O?"Disable":"Enable")+" AI Bot"))}function ne(e){console.info(`${e}`),w=!1}function se(e){console.info(`${e}`),w=!1}function K(e,t){const l=e.getBoundingClientRect();return{x:Math.round((t.clientX-l.left)/(l.right-l.left)*e.width),y:Math.round((t.clientY-l.top)/(l.bottom-l.top)*e.height)}}U()};
