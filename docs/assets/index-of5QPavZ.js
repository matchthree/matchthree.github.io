(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))W(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const X of h.addedNodes)X.tagName==="LINK"&&X.rel==="modulepreload"&&W(X)}).observe(document,{childList:!0,subtree:!0});function o(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function W(c){if(c.ep)return;c.ep=!0;const h=o(c);fetch(c.href,h)}})();function fe(b){console.info("Hello World"),console.info(`The current time is ${b.getHours()}:${b.getMinutes()}:${b.getSeconds()}`)}window.onload=function(){fe(new Date);const a=document.getElementById("viewport");let o=a.getContext("2d"),W=0,c=0,h=0,X=0,Y=!1,l={x:250,y:113,columns:8,rows:8,tileWidth:40,tileHeight:40,tiles:[],selectedTile:{selected:!1,column:0,row:0}},R=[[255,128,128],[128,255,128],[128,128,255],[255,255,128],[255,128,255],[128,255,255],[255,255,255]],s=[],m=[],r={column1:0,row1:0,column2:0,row2:0},y={init:0,ready:1,resolve:2},g=y.init,E=0,w=0,d=0,p=.3,j=!1,L=!1,B=!1,u=[{x:30,y:240,width:150,height:50,text:"New Game"},{x:30,y:300,width:150,height:50,text:"Show Moves"},{x:30,y:360,width:150,height:50,text:"Enable AI Bot"}];function q(){a.addEventListener("mousemove",oe),a.addEventListener("mousedown",ne),a.addEventListener("mouseup",re),a.addEventListener("mouseout",se);for(let e=0;e<l.columns;e++){l.tiles[e]=[];for(let t=0;t<l.rows;t++)l.tiles[e][t]={column:0,row:0,type:0,shift:0},console.info({level:l})}V(),P(0)}function P(e){window.requestAnimationFrame(P),U(e),J()}function U(e){let t=(e-W)/1e3;if(W=e,K(t),g===y.ready){if(m.length<=0&&(B=!0),L&&(d+=t,d>p)){if(C(),m.length>0){let i=m[Math.floor(Math.random()*m.length)];F(i.column1,i.row1,i.column2,i.row2)}d=0}}else if(g===y.resolve){if(d+=t,w===0){if(d>p){if(x(),s.length>0){for(let i=0;i<s.length;i++)E+=100*(s[i].length-2);A(),w=1}else g=y.ready;d=0}}else w===1?d>p&&(I(),w=0,d=0,x(),s.length<=0&&(g=y.ready)):w===2?d>p&&(M(r.column1,r.row1,r.column2,r.row2),x(),s.length>0?(w=0,d=0,g=y.resolve):(w=3,d=0),C(),x()):w===3&&d>p&&(M(r.column1,r.row1,r.column2,r.row2),g=y.ready);C(),x()}}function K(e){c>.25&&(X=Math.round(h/c),c=0,h=0),c+=e,h++}function D(e,t,i,n){if(o==null)return;let f=o.measureText(e);o.fillText(e,t+(n-f.width)/2,i)}function J(){if(Q(),o==null)return;o.fillStyle="#000000",o.font="24px Verdana",D("Score:",30,l.y+40,150),D(E.toString(),30,l.y+70,150),Z();let e=l.columns*l.tileWidth,t=l.rows*l.tileHeight;o.fillStyle="#000000",o.fillRect(l.x-4,l.y-4,e+8,t+8),_(),k(),j&&s.length<=0&&g===y.ready&&ee(),B&&(o.fillStyle="rgba(0, 0, 0, 0.8)",o.fillRect(l.x,l.y,e,t),o.fillStyle="#ffffff",o.font="24px Verdana",D("Game Over!",l.x,l.y+t/2+10,e))}function Q(){o!=null&&(o.fillStyle="#d0d0d0",o.fillRect(0,0,a.width,a.height),o.fillStyle="#e8eaec",o.fillRect(1,1,a.width-2,a.height-2),o.fillStyle="#303030",o.fillRect(0,0,a.width,65),o.fillStyle="#ffffff",o.font="24px Verdana",o.fillText("Match3 Example - Rembound.com",10,30),o.fillStyle="#ffffff",o.font="12px Verdana",o.fillText("Fps: "+X,13,50))}function Z(){for(let e=0;e<u.length;e++){if(o==null)return;o.fillStyle="#000000",o.fillRect(u[e].x,u[e].y,u[e].width,u[e].height),o.fillStyle="#ffffff",o.font="18px Verdana";let t=o.measureText(u[e].text);o.fillText(u[e].text,u[e].x+(u[e].width-t.width)/2,u[e].y+30)}}function _(){for(let e=0;e<l.columns;e++)for(let t=0;t<l.rows;t++){let i=l.tiles[e][t].shift,n=T(e,t,0,d/p*i);if(l.tiles[e][t].type>=0){let f=R[l.tiles[e][t].type];v(n.tileX,n.tileY,f[0],f[1],f[2])}l.selectedTile.selected&&l.selectedTile.column===e&&l.selectedTile.row===t&&v(n.tileX,n.tileY,255,0,0)}if(g===y.resolve&&(w===2||w===3)){let e=r.column2-r.column1,t=r.row2-r.row1,i=T(r.column1,r.row1,0,0),n=T(r.column1,r.row1,d/p*e,d/p*t),f=R[l.tiles[r.column1][r.row1].type],S=T(r.column2,r.row2,0,0),O=T(r.column2,r.row2,d/p*-e,d/p*-t),H=R[l.tiles[r.column2][r.row2].type];v(i.tileX,i.tileY,0,0,0),v(S.tileX,S.tileY,0,0,0),w===2?(v(n.tileX,n.tileY,f[0],f[1],f[2]),v(O.tileX,O.tileY,H[0],H[1],H[2])):(v(O.tileX,O.tileY,H[0],H[1],H[2]),v(n.tileX,n.tileY,f[0],f[1],f[2]))}}function T(e,t,i,n){let f=l.x+(e+i)*l.tileWidth,S=l.y+(t+n)*l.tileHeight;return{tileX:f,tileY:S}}function v(e,t,i,n,f){o!=null&&(o.fillStyle="rgb("+i+","+n+","+f+")",o.fillRect(e+2,t+2,l.tileWidth-4,l.tileHeight-4))}function k(){for(let e=0;e<s.length;e++){let t=T(s[e].column,s[e].row,0,0);if(o==null)return;s[e].horizontal?(o.fillStyle="#00ff00",o.fillRect(t.tileX+l.tileWidth/2,t.tileY+l.tileHeight/2-4,(s[e].length-1)*l.tileWidth,8)):(o.fillStyle="#0000ff",o.fillRect(t.tileX+l.tileWidth/2-4,t.tileY+l.tileHeight/2,8,(s[e].length-1)*l.tileHeight))}}function ee(){for(let e=0;e<m.length;e++){let t=T(m[e].column1,m[e].row1,0,0),i=T(m[e].column2,m[e].row2,0,0);if(o==null)return;o.strokeStyle="#ff0000",o.beginPath(),o.moveTo(t.tileX+l.tileWidth/2,t.tileY+l.tileHeight/2),o.lineTo(i.tileX+l.tileWidth/2,i.tileY+l.tileHeight/2),o.stroke()}}function V(){E=0,g=y.ready,B=!1,te(),C(),x()}function te(){let e=!1;for(;!e;){for(let t=0;t<l.columns;t++)for(let i=0;i<l.rows;i++)l.tiles[t][i].type=z();le(),C(),m.length>0&&(e=!0)}}function z(){return Math.floor(Math.random()*R.length)}function le(){for(x();s.length>0;)A(),I(),x()}function x(){s=[];for(let e=0;e<l.rows;e++){let t=1;for(let i=0;i<l.columns;i++){let n=!1;i===l.columns-1?n=!0:l.tiles[i][e].type===l.tiles[i+1][e].type&&l.tiles[i][e].type!==-1?t+=1:n=!0,n&&(t>=3&&s.push({column:i+1-t,row:e,length:t,horizontal:!0}),t=1)}}for(let e=0;e<l.columns;e++){let t=1;for(let i=0;i<l.rows;i++){let n=!1;i===l.rows-1?n=!0:l.tiles[e][i].type===l.tiles[e][i+1].type&&l.tiles[e][i].type!==-1?t+=1:n=!0,n&&(t>=3&&s.push({column:e,row:i+1-t,length:t,horizontal:!1}),t=1)}}}function C(){m=[];for(let e=0;e<l.rows;e++)for(let t=0;t<l.columns-1;t++)M(t,e,t+1,e),x(),M(t,e,t+1,e),s.length>0&&m.push({column1:t,row1:e,column2:t+1,row2:e});for(let e=0;e<l.columns;e++)for(let t=0;t<l.rows-1;t++)M(e,t,e,t+1),x(),M(e,t,e,t+1),s.length>0&&m.push({column1:e,row1:t,column2:e,row2:t+1});s=[]}function ie(e){for(let t=0;t<s.length;t++){let i=s[t],n=0,f=0;for(let S=0;S<i.length;S++)e(t,i.column+n,i.row+f,i),i.horizontal?n++:f++}}function A(){ie(function(e,t,i,n){console.info("hello, cluster"),console.info({cluster:n}),console.info({index:e}),l.tiles[t][i].type=-1});for(let e=0;e<l.columns;e++){let t=0;for(let i=l.rows-1;i>=0;i--)l.tiles[e][i].type===-1?(t++,l.tiles[e][i].shift=0):l.tiles[e][i].shift=t}}function I(){for(let e=0;e<l.columns;e++)for(let t=l.rows-1;t>=0;t--){if(l.tiles[e][t].type===-1)l.tiles[e][t].type=z();else{let i=l.tiles[e][t].shift;i>0&&M(e,t,e,t+i)}l.tiles[e][t].shift=0}}function N(e){let t=Math.floor((e.x-l.x)/l.tileWidth),i=Math.floor((e.y-l.y)/l.tileHeight);return t>=0&&t<l.columns&&i>=0&&i<l.rows?{valid:!0,x:t,y:i}:{valid:!1,x:0,y:0}}function G(e,t,i,n){return Math.abs(e-i)===1&&t===n||Math.abs(t-n)===1&&e===i}function M(e,t,i,n){let f=l.tiles[e][t].type;l.tiles[e][t].type=l.tiles[i][n].type,l.tiles[i][n].type=f}function F(e,t,i,n){r={column1:e,row1:t,column2:i,row2:n},l.selectedTile.selected=!1,w=2,d=0,g=y.resolve}function oe(e){let t=$(a,e);if(Y&&l.selectedTile.selected){let i=N(t);i.valid&&G(i.x,i.y,l.selectedTile.column,l.selectedTile.row)&&F(i.x,i.y,l.selectedTile.column,l.selectedTile.row)}}function ne(e){let t=$(a,e),i;if(!Y){if(i=N(t),i.valid){let n=!1;if(l.selectedTile.selected)if(i.x===l.selectedTile.column&&i.y===l.selectedTile.row){l.selectedTile.selected=!1,Y=!0;return}else G(i.x,i.y,l.selectedTile.column,l.selectedTile.row)&&(F(i.x,i.y,l.selectedTile.column,l.selectedTile.row),n=!0);n||(l.selectedTile.column=i.x,l.selectedTile.row=i.y,l.selectedTile.selected=!0)}else l.selectedTile.selected=!1;Y=!0}for(let n=0;n<u.length;n++)t.x>=u[n].x&&t.x<u[n].x+u[n].width&&t.y>=u[n].y&&t.y<u[n].y+u[n].height&&(n===0?V():n===1?(j=!j,u[n].text=(j?"Hide":"Show")+" Moves"):n===2&&(L=!L,u[n].text=(L?"Disable":"Enable")+" AI Bot"))}function re(e){console.info("onMouseUp()"),console.info({e}),Y=!1}function se(e){console.info("onMouseOut()"),console.info({e}),Y=!1}function $(e,t){let i=e.getBoundingClientRect();return{x:Math.round((t.clientX-i.left)/(i.right-i.left)*e.width),y:Math.round((t.clientY-i.top)/(i.bottom-i.top)*e.height)}}q()};
